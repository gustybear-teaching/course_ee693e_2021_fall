---
title: "02: Heart-to-Heart(H2H): 
Authentication for Implanted Medical Devices
M. Rostami, A. Juels, F. Koushanfar"

date: 2021-10-27
type: book
commentable: true
# Provide the name of the presenter
summary: "Presenter(s): Clyde James Felix, Jeana Wadsack-Myers and Banh Nguyen "
# Provide other tags that describe the paper
tags:
- teaching
- ee693e
- Cryptography
- ECG
---
***
## Paper Summary
Implantable Medical Device (IMD) applies continuous monitoring therapies for chronic medical disordered patients. Patients have been implanted with IMDs to assess vital signs. To reprogram the IMD and to extract its data, a Commercial Device Programmers is a device that can perform these tasks wirelessly. A problem with this technology is the security risk that can harm patients. Hackers can seize unauthorized control of the IMDs. This paper proposes Heart-to-Heart (H2H) that establishes a novel access-control policy between the programmer and the IMD. H2H utilizes Electrocardiogram signals to generate random key sources to authorize control to IMDs. This paper further discusses the validity of ECG signals for authentication by examining their entropy. This paper also described the cryptographic pairing protocol between the programmer and the IMD and tested it on an adversarial model. Lastly, this paper describes the full implementation of H2H while displaying code size and power consumption analysis.
***
## Presentation
{{< youtube cQj1CtbFsMI >}}
***
## Review
### Strengths
- Provides greater security for the IMDs
- Provides a protocol for crucial cases (i.g. patient ECG goes flat)

### Weaknesses
- Limitation of having to touch the patient for authentication.

### Detailed Comments
This paper considers the system of using the IMD and the programmer. In this system, programmers can wirelessly extract data and reprogram the IMDs. The IMD system brings security risks that can potentially harm patients. While implementing security to the system, IMDs must offer permissive access control policies for life-threatening events. By balancing between the two challenges, implementing a security protocol for this application can be difficult. Heart-to-Heart is the proposed solution that uses touch-to-access to gain access to the IMD. For this proposal, the programmer and the IMD must measure ECG signals. The ECG signals then generate random key sources for authentication. If ECG signals are closely similar to each other, programmers gain access from the IMDs.

In this paper, the authors had to examine whether ECG signals are capable of producing pure random numbers for authentication. The approach of the validation is to investigate the entropies of the ECG signals. The result from this experiment is that ECGs are capable of producing 4 bits of random numbers with high entropies for authentication.

One advantage of H2H is that it protects from attackers by providing touch-to-access security. H2H provides protocols for different scenarios (i.g. when a patient ECG signal goes flat). A disadvantage of this proposal is the limitation of having touch-to-access between the programmer and the IMD. 

Implantable Medical Devices (IMDs) automate the monitoring and treatment of chronic medical diseases. They are often lodged partly or completely into the bodies of patients. H2H's answer is a straightforward access control policy for IMDs dubbed "touch-to-access." While the H2H design may theoretically be powered by any PV, we will concentrate on the utilization of the waveform generated by the heart, referred to as an ECG (electrocardiogram) It is well-suited for authentication of cardiac IMDs such as ICDs and pacemakers, which constitute the majority of powered IMDs today. H2H can secure both new and old in-vivo IMDs with firmware upgrades, as long as the H2H implementation fits the IMD's memory and computational resource constraints.

Unlike earlier work, their technique is based on the Neyman-Pearson Lemma, rather than naively on Hamming distance. They describe a novel pairing approach that takes use of the statistical uncorrelated nature of keysource bits in order to consider them as one-time authentication values. On an ARM Cortex-M3 CPU, they present a complete implementation of H2H and report on resource requirements and power consumption.

The ECG signal is a good candidate for modeling as a stochastic process, i.e. one that is not stationary. We demonstrate how to extract four high-grade random components from an ECG waveform in order to construct a signal that is well represented by a wide-sense stationary stochastic process. H2H effectively gathers PV randomness to provide rapid authentication. When an acute heart attack occurs, the ECG waveform becomes flat. During a Programmer-to-IMD authentication session, H2H simulates the presence of an attacker. It has total network control, i.e., it is capable of dropping (jamming) and replaying, replaying, and forging communications at whim.

IPIs are not time-independent. We analyzed a 2Mbit dataset that included 48 half-hour ECG recordings from 47 people in the MIT-BIH ArrhythmiaDatabase and 250 patients in the MGH/MFWaveform Database. The error rates for IPI-derived bits in the H2H configuration are determined using external ECG leads. The error rate varies significantly across quantized bits; the lower the bit's importance, the greater the error rate and entropy.

In H2H, a PV contains just the four least important bits of anIPI, which we collectively refer to as IPI4. An opponent who has not had physical contact with a victim and has no knowledge of IPIs can only make an educated estimate at an IPI 4 value. They may create a compact representation of P(n) and Q(n) for a given number of n. 

They can effectively calculate Th using a brute force technique. Algorithm 1 is done offline, not in the IMD, and takes 0.2 second for n = 15 and 8 seconds for all numbers between 1 and 25. The trade-offs between false negative rates (FNReq) and false positive rates (FP) are shown in Figure 4 for a variety of n of IPI4 values utilized in authentication. The bigger n, the more favorable FNReq and FP are. However, when n increases, the ECG measurement duration in an H2H authentication increases as well.

Of course, an attacker may try several times against theIMD and the Programmer. One effective countermeasure is exponential backoff in the IMD. Without major advancements, they believe that PPG is unlikely to represent a serious threat to H2H.

They explain why we do not utilize current cryptographic techniques for H2H in this essay. They then describe the protocol and a security analysis for a novel method to device authentication based on physiological value (PV) and their physical equivalents, the Programmer and the IMD. The IMD and Programmer create a secure link through Transport Layer Security in the first step of our protocol (TLS). IMD waits a complete PV read cycle after an incorrect authentication attempt before approving a fresh authentication request. This delay avoids interleaving attacks, in which the session of a Programmer overlaps with the sessions of two IMDs. The objective of Adv is to begin a session with the IMD on SecChannel such that it outputs an accept for a session with the Programmer. Theorem 1 reflects the fact that the optimum approach for Adv against H2His is to begin concurrent sessions with the IMD and Programmer, which read PVs from the patient's private key, respectively (PV).

IMDs are vulnerable to attack by rogue programmers who may compromise patient privacy and modify data and functionality, posing a risk to patients. Securing IMDs needs a delicate combination of technology and legislation. PV/ECG authentication may be used to secure intersensor connections in body area networks (BANs). The suggested shield is worn close to the body and is used to authenticate / mediate Programmer interactions (or other. communications with the IMD). Implantable Medical Devices (IMDs) are susceptible to assault since they may be wirelessly accessed and updated by external devices with lax access control settings. H2H is the first ECG-based authentication technique that uses a robust statistical model to discriminate between honest and malicious ECG data.

### Implementation
H2H was implemented into an IMD prototype consisting of three boards which can be seen from Figure 6. The ARM board was chosen to be the Leopard Gecko EFM-32 microcontroller (EFM32LG-DK3650) with a 32-bit ARM Cortex-M3 processor. This board communicates with the ECG analog front end (TI ADS1298) and the wireless board (TI CC430F5137). It has convenient power debugging tools and can extract the ECG features and communicate with the Programmer using TLS all while having a good power consumption profile.

TLS is used to establish the secure channel implementation between the Programmer and H2H. It is designed to provide an encrypted and authenticated channel between the two parties, usually comparing the Programmer certificate to PKI. However, the authors chose to forgo that for the ECG PV comparison which is more forgiving to the noise typical in ECG signals. RSA encryption for key exchange is chosen since it is the fastest exchange option for TLS in this application which has a small public exponent of 216 + 1. The RSA follows the NIST key length recommendation of modulus and message length set to 2048 bits and is also MISRA-C standard compliant. 

A NIST-recommended pseudo-random number generator or PRNG is used to allow certain actions such as RSA ciphertext padding and key generation and commitment. The initial random seed is generated offline and stored in the IMDâ€™s non-volatile memory. As for ECG parameter extraction, the prototype annotates the ECG R-peaks by using an open source algorithm called WQRS to apply a simple length transformation to the ECG waveform.


### Experimentation
<!-- {{< figure src="https://github.com/gustybear-teaching/course_ee693e_2021_fall/raw/main/week_02/images/responsetime.jpg" title="Response Time" width="300" >}}

{{< figure src="https://github.com/gustybear-teaching/course_ee693e_2021_fall/raw/main/week_02/images/successrate.jpg" title="Success Rate with One Round" width="300" >}}

{{< figure src="https://github.com/gustybear-teaching/course_ee693e_2021_fall/raw/main/week_02/images/multipleattempts.jpg" title="Success Rate with Multiple Rounds" width="300" >}} -->

### Discussion
There are three broad technical approaches other papers have explored with comparison to H2H. The first is distance bounding which focuses on acoustic transmission of a random key. Halperin et al. tested authentication with a piezo device while Rasmussen et al. tested a similar ultrasound-based approach. However, it was found that this security model was too fragile and also comes with added energy cost and RF shielding requirements. 
The next technical approach is called shielding which is the idea of blocking inappropriate access to an IMD. There are two comparisons made with a wearable device called IMDGuard  and the works of Gollakota et al. In the end, the external burdens of a wearable device plus an increase in system failures make it an inferior method. 
Lastly, PV based authentication is mentioned in numerous works. However, none have done a rigorous security analysis like H2H and have been exposed to serious issues. 
Overall, the H2H prototype implementation confirms the promise of security, practicality and low overhead of H2H for current and future generations of IMDs.


### Questions
(1) Do you think other biometrics can be used for H2H? Something other than PV?

- Respiration measurements can be also used for authentication. The proposal of this paper might have a different approach. The entopies of the biometrics have to be investigated to decide whether those are good for authentication.
- H2H makes use of a time-varying biometric, often referred to as a physiological value (PV). Thus, any time-varying biometric with a high entropy value may be considered for H2H.

(2) Would there be a noticable difference in running time for the algorithm shown? Is it worth improving the n4logn time complexity?

- It is possible to improve time complexity of the algorithm by using another sorting algorithm. Further research has to be conducted. 
- Although there is surely a method to enhance the big O, this algorithm just runs once and takes 0.2 seconds to complete. As a result, the debate becomes whether we should devote time in improving it or focusing on other priorities.

(3) Would x86 or other CISC architecture offer a better performance in place of the ARM architecture?
- Any processor can be used for the IMD. Although the choice of using ARM processor is not explained in the paper, It should be best to choose a processor that consumes less power.
- They said that "We describe a full implementation of H2H in an ARM Cortex-M3 processor, reporting resource requirements such as code size and power consumption, and demonstrating the feasibility of H2H for use in contemporary IMDs." Thus, the ARM processor was chosen due to resource constraints like as code size and power consumption.

